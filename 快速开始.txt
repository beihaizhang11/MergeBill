===============================================
Excel账单合并工具 - 快速开始指南
===============================================

一、运行程序
-----------

方式1：直接运行Python程序
  双击 run.bat
  或
  命令行输入：python main.py

方式2：运行EXE程序（需先打包）
  双击 build.bat 打包成exe
  然后运行 dist\Excel账单合并工具.exe


二、首次使用（5分钟快速上手）
--------------------------

步骤1：配置预设
~~~~~~~~~~~~~~
1. 打开程序后，点击【管理预设】按钮
2. 选择"默认预设"或点击【新建】创建新预设
3. 配置要提取的数据项：
   
   例如：
   项目名称：日期
   单元格位置：A2
   说明：账单日期
   
   项目名称：客户名称
   单元格位置：B2
   说明：客户姓名
   
   项目名称：金额
   单元格位置：C2
   说明：账单金额

4. 配置结算金额提取（可选）：
   结算金额搜索列：D
   结算金额关键词：折后总计
   
5. 点击【保存配置】

6. 关闭配置窗口


步骤2：添加Excel文件
~~~~~~~~~~~~~~~~~~~
返回主界面后：

方法A - 添加多个文件：
  点击【添加文件】→ 按住Ctrl选择多个文件 → 打开

方法B - 添加整个文件夹：
  点击【添加文件夹】→ 选择文件夹 → 程序自动找到所有Excel文件


步骤3：开始合并
~~~~~~~~~~~~~~
1. 确认预设选择正确
2. 确认文件列表中的文件都正确
3. 点击【开始合并】按钮
4. 选择保存位置和文件名
5. 等待处理完成
6. 查看合并结果


三、使用技巧
-----------

技巧1：如何知道数据在哪个单元格？
  在配置界面点击【预览Excel】，选择一个样本文件
  点击单元格即可查看其位置（如A2、B5等）

技巧2：如何快速添加大量文件？
  使用【添加文件夹】功能，程序会递归扫描所有子文件夹

技巧3：如何处理不同类型的账单？
  为不同账单模板创建不同的预设
  使用时选择对应的预设即可

技巧4：如何删除不需要的文件？
  在文件列表中选中文件，点击【移除选中】

技巧5：如何备份配置？
  复制程序目录下的 config.json 文件即可


四、常见使用场景
---------------

场景1：合并月度账单
  1. 创建预设"月度账单"
  2. 配置：日期、客户、金额、折扣、总计等项目
  3. 添加整个月的账单文件夹
  4. 一键合并

场景2：统计多个客户的账单
  1. 所有账单放在同一文件夹
  2. 使用【添加文件夹】批量导入
  3. 合并后在Excel中进行筛选和统计

场景3：不同部门的账单格式不同
  1. 为每个部门创建对应的预设
  2. 处理A部门账单时选择"A部门预设"
  3. 处理B部门账单时选择"B部门预设"


五、示例配置
-----------

示例1：简单账单
~~~~~~~~~~~~~~~
假设Excel格式：
  A列：日期
  B列：客户
  C列：金额

配置映射：
  日期 → A1
  客户 → B1
  金额 → C1


示例2：带折扣的账单
~~~~~~~~~~~~~~~~~~
假设Excel格式：
  A列：日期
  B列：客户
  C列：原价
  D列：项目说明（包含"折后总计"）
  E列：实际金额

配置映射：
  日期 → A1
  客户 → B1
  原价 → C1

结算金额配置：
  搜索列：D
  关键词：折后总计
（程序会自动在D列找到"折后总计"，然后提取E列的值）


六、注意事项
-----------
1. 所有要合并的文件必须使用相同的模板格式
2. 单元格位置要准确（可用预览功能确认）
3. 首次使用建议用2-3个文件测试
4. 结算金额功能会提取关键词右侧单元格的值
5. 如果某些文件缺少数据，对应单元格会显示为空


七、快速排错
-----------

问题：合并后某列全是空值
解决：检查单元格位置配置是否正确，使用预览功能确认

问题：结算金额全是空
解决：检查搜索列和关键词设置，确保Excel中确实有该关键词

问题：添加文件夹后没有文件
解决：确认文件夹中有.xlsx或.xls格式的文件

问题：合并失败提示错误
解决：检查Excel文件是否损坏，是否被其他程序占用


八、获取帮助
-----------
1. 查看 README.md 获取完整文档
2. 查看 打包说明.txt 了解如何打包exe
3. 使用调试版本（build_with_console.bat）查看错误详情


===============================================
祝您使用愉快！
===============================================

